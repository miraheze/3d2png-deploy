{"version":3,"sources":["image-ms-ssim.min.js","/source/image-ms-ssim.min.js"],"names":["f","exports","module","define","window","length","require","global","o","n",1,"i","l","s","t","e","r","IR","ImageMSSSIM","SSIM","compare","image1","image2","windowSize","K1","K2","luminance","bitsPerComponent","WEIGHT","mssim","mcs","im1","im2","w","width","h","height","res","ssim","Math","floor","data","Uint8Array","channels","linear","msssim","pow","image-resize-linear","image-ssim",2,"ImageResizeLinear","from","to","fx","fy","fx0","fy0","rx","ry","rx1","ry1","p1","p2","p3","p4","w1","w2","w3","w4","sw","sh","lw","lh","ty","tx","c",3,"ImageSSIM","iteration","lumaValues1","lumaValues2","averageLumaValue1","averageLumaValue2","sigxy","sigsqx","sigsqy","numPixelsInWin","numerator","c1","c2","denominator","numWindows","Error","L","Internals","_iterate","Channels","callback","y","x","windowWidth","min","windowHeight","_lumaValuesForWindow","averageLuma1","_averageLuma","averageLuma2","image","array","lumaValues","Float32Array","ArrayBuffer","counter","maxj","j","offset","maxi","sumLuma"],"mappings":"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","file":"image-ms-ssim.min.js","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map","!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map"],"sourceRoot":"/source/"}